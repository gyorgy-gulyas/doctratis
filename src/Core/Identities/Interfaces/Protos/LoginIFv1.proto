
// <auto-generated>
//     This code was generated by d3i.interpreter
//
//     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
// </auto-generated>
syntax = "proto3";

option csharp_namespace = "Core.Identities.Protos.LoginIF_v1";
option java_outer_classname = "LoginIF_v1";
option java_package = "com.Identities";
option java_multiple_files = true;

package Core.Identities;

import "google/protobuf/timestamp.proto";
import "servicekit_error.proto";

service LoginIF_v1 {
	rpc LoginWithEmailPassword(LoginIF_v1_LoginWithEmailPasswordRequest) returns (LoginIF_v1_LoginWithEmailPasswordResponse);
	rpc LoginTwoFactor(LoginIF_v1_LoginTwoFactorRequest) returns (LoginIF_v1_LoginTwoFactorResponse);
}

message LoginIF_v1_LoginWithEmailPasswordRequest {
	string email = 1;
	string password = 2;
}

message LoginIF_v1_LoginWithEmailPasswordResponse {
	oneof result {
		LoginResultDTO Value = 1;
		ServiceKit.Protos.Error Error = 2;
	}
}

message LoginIF_v1_LoginTwoFactorRequest {
	string totp = 1;
}

message LoginIF_v1_LoginTwoFactorResponse {
	oneof result {
		TokensDTO Value = 1;
		ServiceKit.Protos.Error Error = 2;
	}
}
message TokensDTO {
	string AccessToken = 1;
	string RefreshToken = 2;
	google.protobuf.Timestamp AccessTokenExpiredAt = 3;
}

message LoginResultDTO {
	TokensDTO tokens = 1;
	bool required2FA = 2;
}

